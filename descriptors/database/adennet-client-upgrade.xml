<?xml version="1.0" encoding="UTF-8"?>
<!--
 SARATHI SOFTECH PVT. LTD. CONFIDENTIAL
 _____________________

 [2024] Sarathi Softech Pvt. Ltd.
 All Rights Reserved.

 NOTICE:  All information contained herein is and remains
 the property of Sarathi Softech.
 The intellectual and technical concepts contained
 herein are proprietary to Sarathi Softech
 and are protected by IP copyright law.
 Dissemination of this information or reproduction of this material
 is strictly forbidden.
-->

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.2.xsd"
                   logicalFilePath="descriptors/database/adennet-client-upgrade.xml">

    <changeSet context = "base" id = "JBADEN-62" author = "Onkar Pawar">
        <comment>External configurations</comment>
        <insert tableName = "pluggable_task_type_category">
            <column name = "id"             valueNumeric = "(SELECT MAX(type.id)+1 FROM pluggable_task_type_category type)" />
            <column name = "interface_name" value        = "com.sapienter.jbilling.server.externalservice.configuration.ExternalConfigurationTask" />
        </insert>

        <insert tableName = "pluggable_task_type">
            <column name = "id"             valueComputed = "COALESCE((SELECT MAX(p.id)+1 FROM pluggable_task_type p),1)" />
            <column name = "category_id"    valueComputed = "(SELECT type.id FROM pluggable_task_type_category type WHERE type.interface_name='com.sapienter.jbilling.server.externalservice.configuration.ExternalConfigurationTask')" />
            <column name = "class_name"     value         = "com.sapienter.jbilling.server.adennet.AdennetExternalConfigurationTask" />
            <column name = "min_parameters" valueNumeric  = "3" />
        </insert>

        <insert tableName = "international_description">
            <column name = "table_id"     valueNumeric  = "24"/>
            <column name = "foreign_id"   valueComputed = "(SELECT MAX(p.id) FROM pluggable_task_type p)"/>
            <column name = "psudo_column" value         = "description"/>
            <column name = "language_id"  valueNumeric  = "1"/>
            <column name = "content"      value         = "External Configurations."/>
        </insert>
    </changeSet>

    <changeSet id="JBADEN-34-Customer-Enrolment-Upload-Image" author="Onkar Pawar" context="base">
        <addColumn tableName="customer">
            <column name="national_id" type="java.sql.Types.VARCHAR(30)">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addColumn tableName="customer">
            <column name="national_id_file_name" type="java.sql.Types.VARCHAR(100)">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addColumn tableName="customer">
            <column name="passport_number" type="java.sql.Types.VARCHAR(30)">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addColumn tableName="customer">
            <column name="passport_file_name" type="java.sql.Types.VARCHAR(100)">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addColumn tableName="customer">
            <column name="company_letter_file_name" type="java.sql.Types.VARCHAR(100)">
                <constraints nullable="true"/>
            </column>
        </addColumn>

        <insert tableName="preference_type">
            <column name="id" valueComputed="COALESCE((select max(pt.id)+1 from preference_type pt),1)"/>
            <column name="def_value" value="0"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueComputed="(select id From jbilling_table where name = 'preference_type')"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(pt.id) from preference_type pt),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Capture identification document for the customer"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="JBADEN-168: Finance Total Report" author="Nitin Yewale">
        <comment>New Report for Adennet finance team to check total payment</comment>

        <insert tableName="report_type">
            <column name="id" valueComputed="coalesce((select max(t.id) + 1 from report_type t), 1)"/>
            <column name="name" value="adennet"/>
            <column name="optlock" valueNumeric="0"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="101"/>
            <column name="foreign_id" valueComputed="(select id from report_type where name='adennet')"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Adennet Reports"/>
        </insert>

        <insert tableName = "report">
            <column name  = "id"        valueComputed = "COALESCE((SELECT MAX(id)+1 FROM report),1)" />
            <column name  = "type_id"   valueComputed = "COALESCE((SELECT id FROM report_type rt WHERE rt.name = 'adennet'),1)" />
            <column name  = "name"      value         = "adennet_ums_finance_total_report" />
            <column name  = "file_name" value         = "adennet_ums_finance_total_report.jasper" />
            <column name  = "optlock"   valueNumeric  = "0" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)" />
            <column name = "dtype"     value         = "date" />
            <column name = "name"      value         = "start_date" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)" />
            <column name = "dtype"     value         = "date" />
            <column name = "name"      value         = "end_date" />
        </insert>

        <sql>
            INSERT INTO entity_report_map(report_id, entity_id)
            SELECT (SELECT r.id
            FROM report r
            WHERE r.name = 'adennet_ums_finance_total_report'),
            id
            FROM entity
            WHERE deleted = 0
        </sql>
    </changeSet>

    <changeSet context="base" id="JBADEN-168: CRM User Report" author="Nitin Yewale">
        <comment>New Report for Adennet CRM User</comment>

        <insert tableName = "report">
            <column name  = "id"        valueComputed = "COALESCE((SELECT MAX(id)+1 FROM report),1)" />
            <column name  = "type_id"   valueComputed = "COALESCE((SELECT id FROM report_type rt WHERE rt.name = 'adennet'),1)" />
            <column name  = "name"      value         = "adennet_ums_crm_user_report" />
            <column name  = "file_name" value         = "adennet_ums_crm_user_report.jasper" />
            <column name  = "optlock"   valueNumeric  = "0" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)" />
            <column name = "dtype"     value         = "date" />
            <column name = "name"      value         = "start_date" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)" />
            <column name = "dtype"     value         = "date" />
            <column name = "name"      value         = "end_date" />
        </insert>

        <sql>
            INSERT INTO entity_report_map(report_id, entity_id)
            SELECT (SELECT r.id
            FROM report r
            WHERE r.name = 'adennet_ums_crm_user_report'),
            id
            FROM entity
            WHERE deleted = 0
        </sql>
    </changeSet>

    <changeSet context="base" id="JBADEN-168: Bank User Report" author="Nitin Yewale">
        <comment>New Report for Adennet Bank User Report</comment>

        <insert tableName = "report">
            <column name  = "id"        valueComputed = "COALESCE((SELECT MAX(id)+1 FROM report),1)" />
            <column name  = "type_id"   valueComputed = "COALESCE((SELECT id FROM report_type rt WHERE rt.name = 'adennet'),1)" />
            <column name  = "name"      value         = "adennet_ums_bank_user_report" />
            <column name  = "file_name" value         = "adennet_ums_bank_user_report.jasper" />
            <column name  = "optlock"   valueNumeric  = "0" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_bank_user_report'),1)" />
            <column name = "dtype"     value         = "date" />
            <column name = "name"      value         = "start_date" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_bank_user_report'),1)" />
            <column name = "dtype"     value         = "date" />
            <column name = "name"      value         = "end_date" />
        </insert>

        <sql>
            INSERT INTO entity_report_map(report_id, entity_id)
            SELECT (SELECT r.id
            FROM report r
            WHERE r.name = 'adennet_ums_bank_user_report'),
            id
            FROM entity
            WHERE deleted = 0
        </sql>
    </changeSet>

    <changeSet context="base" id="JBADEN-206 : Adding new Recharge and Buy Subscription permissions" author="Vipul Yadav">
        <comment>Add a new permissions Recharge and Buy Subscription under customer type</comment>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Recharge"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Buy Subscription"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>
    </changeSet>

    <changeSet context = "base" id = "JBADEN-183: Recharge Transaction History" author = "Nitin Yewale">
        <comment>Show Recharge History Transactions</comment>
        <insert tableName = "tab">
            <column name = "id"              valueComputed = "(SELECT MAX(id)+1 FROM tab)"/>
            <column name = "message_code"    value         = "menu.link.recharge.history"/>
            <column name = "controller_name" value         = "rechargeTransactionHistory"/>
            <column name = "access_url"      value         = "/rechargeTransactionHistory"/>
            <column name = "required_role"   value         = ""/>
            <column name = "version"         valueNumeric  = "1"/>
            <column name = "default_order"   valueComputed = "(SELECT MAX(default_order)+1 FROM tab)"/>
        </insert>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Menu')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Show recharge history menu"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>
    </changeSet>

    <changeSet context = "base" id = "JBADEN-227: Permissions based configurations" author = "Sachet Shandilya">
        <comment>Permissions for Suspend/Activation and Reissue Under PRODUCT CATEGORY STATUS AND ASSETS, View National ID/ Passport under CUSTOMER</comment>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Product Category Status and Assets')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Suspend / Activate"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Product Category Status and Assets')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="SIM card reissue"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="View customer identity document"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

    </changeSet>

    <changeSet context="base" id="JBADEN-241: last-six-month-inactive-subscriber-number" author="Nitin Yewale">
        <comment>New Report for Inactive Subscriber Number</comment>

        <insert tableName = "report">
            <column name  = "id"        valueComputed = "COALESCE((SELECT MAX(id)+1 FROM report),1)" />
            <column name  = "type_id"   valueComputed = "COALESCE((SELECT id FROM report_type rt WHERE rt.name = 'adennet'),1)" />
            <column name  = "name"      value         = "adennet_ums_inactive_subscriber_numbers_report" />
            <column name  = "file_name" value         = "adennet_ums_inactive_subscriber_numbers_report.jasper" />
            <column name  = "optlock"   valueNumeric  = "0" />
        </insert>
        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_inactive_subscriber_numbers_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "inactive_since" />
        </insert>
        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_inactive_subscriber_numbers_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "inactive_month" />
        </insert>
        <sql>
            INSERT INTO entity_report_map(report_id, entity_id)
            SELECT (SELECT r.id
            FROM report r
            WHERE r.name = 'adennet_ums_inactive_subscriber_numbers_report'),
            id
            FROM entity
            WHERE deleted = 0
        </sql>
    </changeSet>

    <changeSet context = "base" id = "JBADEN-257" author = "Krunal Bhavar">
        <comment>Adennet Cache RefreshTask</comment>
        <insert tableName = "pluggable_task_type">
            <column name = "id"             valueComputed = "COALESCE((SELECT MAX(p.id)+1 FROM pluggable_task_type p),1)" />
            <column name = "category_id"    valueNumeric  = "17" />
            <column name = "class_name"     value         = "com.sapienter.jbilling.server.adennet.AdennetCacheRefreshTask" />
            <column name = "min_parameters" valueNumeric  = "1" />
        </insert>

        <insert tableName = "international_description">
            <column name = "table_id"     valueNumeric  = "24"/>
            <column name = "foreign_id"   valueComputed = "(SELECT MAX(p.id) FROM pluggable_task_type p)"/>
            <column name = "psudo_column" value         = "description"/>
            <column name = "language_id"  valueNumeric  = "1"/>
            <column name = "content"      value         = "Adennet Cache RefreshTask."/>
        </insert>
    </changeSet>

    <changeSet id="jbaden-286-ICCID-changes-for-asset-dto" author="Vipul Yadav" context="base">
        <addColumn tableName="asset">
            <column name="subscriber_number" type="java.sql.Types.VARCHAR(10)">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addColumn tableName="asset">
            <column name="imsi" type="java.sql.Types.VARCHAR(25)">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="asset">
            <column defaultValueBoolean="false" name="is_suspended" type="java.sql.Types.BOOLEAN">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="asset">
            <column name="pin_1" type="java.sql.Types.INTEGER">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addColumn tableName="asset">
            <column name="pin_2" type="java.sql.Types.INTEGER">
                <constraints nullable="true"/>
            </column>
        </addColumn>
        <addColumn tableName="asset">
            <column name="puk_1" type="java.sql.Types.INTEGER">
                <constraints nullable="true"/>
            </column>
        </addColumn>

        <addColumn tableName="asset">
            <column name="puk_2" type="java.sql.Types.INTEGER">
                <constraints nullable="true"/>
            </column>
        </addColumn>

        <addColumn tableName="asset">
            <column name="discarded_identifier" type="java.sql.Types.VARCHAR(200)">
                <constraints nullable="true"/>
            </column>
        </addColumn>

    </changeSet>

    <changeSet id="JBADEN-343" author="Sachet Shandilya" context="base">
        <addColumn tableName="customer">
            <column name="identification_type" type="java.sql.Types.VARCHAR(30)" defaultValue = "NA">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="customer">
            <column name="identification_number" type="java.sql.Types.VARCHAR(30)" defaultValue = "NA">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="customer">
            <column name="identification_image" type="java.sql.Types.VARCHAR(100)" defaultValue = "NA">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet context = "base" id = "JBADEN-351" author = "Sachet Shandilya">
        <comment>Permissions for Change customer type, Refund wallet balance, View all recharge transactions, Refund recharge transaction under CUSTOMER, Release Under PRODUCT CATEGORY STATUS AND ASSETS</comment>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Change customer type"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Refund wallet balance"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="View all recharge transactions"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Refund recharge transaction"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Product Category Status and Assets')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Release"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

    </changeSet>

    <changeSet context = "base" id = "JBADEN-351: add report permissions" author = "Sachet Shandilya">
        <comment>New Permission type for Report and Permissions for View Bank User Report, View CRM User Report, View Finance Total Report, View Inactive Subscriber Numbers Report under REPORT</comment>

        <insert tableName="permission_type">
            <column name="id" valueComputed="(select max(pt.id)+1 from permission_type pt)"/>
            <column name="description" value="Report"/>
        </insert>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Report')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="View CRM User Report"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Report')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="View Bank User Report"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Report')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="View Finance Total Report"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Report')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="View Inactive Subscriber Numbers Report"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>
    </changeSet>

    <changeSet context="base" id="JBADEN:349 CRM User Report" author="Nitin Yewale">
        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "action_type" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "action_type" />
        </insert>
    </changeSet>

    <changeSet context="base" id="JBADEN-376: Update change set" author="Vipul Yadav">
        <comment>Update change set as per new changes</comment>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "subscriber_number" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "user_name" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_bank_user_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "subscriber_number" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_bank_user_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "bank_user_name" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "process_type" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)"/>
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "subscriber_number" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)"/>
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "user_name" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)"/>
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "process_type" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "governorate" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)"/>
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "governorate" />
        </insert>

        <dropColumn tableName="customer" columnName="national_id"/>
        <dropColumn tableName="customer" columnName="national_id_file_name"/>
        <dropColumn tableName="customer" columnName="passport_number"/>
        <dropColumn tableName="customer" columnName="passport_file_name"/>
        <dropColumn tableName="customer" columnName="company_letter_file_name"/>

    </changeSet>

    <changeSet context="base" id="JBADEN-376: Update table customer" author="Vipul Yadav">
        <comment>Update constraint </comment>
        <dropNotNullConstraint tableName="customer" columnName="identification_type" columnDataType="java.sql.Types.VARCHAR(30)"/>
        <dropNotNullConstraint tableName="customer" columnName="identification_number" columnDataType="java.sql.Types.VARCHAR(30)"/>
        <dropNotNullConstraint tableName="customer" columnName="identification_image" columnDataType="java.sql.Types.VARCHAR(100)"/>
    </changeSet>

    <changeSet context="base" id="JBADEN-374: update data_type" author="Nitin Yewale">
        <comment>Update finance total report data type for column process_type </comment>
        <update tableName="report_parameter">
            <column name="dtype" value="list" />
            <where>id=115</where>
        </update>
        <update tableName="report_parameter">
            <column name="dtype" value="list" />
            <where>id=118</where>
        </update>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)"/>
            <column name = "dtype"     value         = "list" />
            <column name = "name"      value         = "actions" />
        </insert>
        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)"/>
            <column name = "dtype"     value         = "list" />
            <column name = "name"      value         = "actions" />
        </insert>
    </changeSet>


    <changeSet context = "base" id = "JBADEN-412" author = "Vipul Yadav">
        <comment>modify data type in asset table for pin_1, pin_2, puk_1 and pik_2 </comment>
        <modifyDataType tableName = "asset"
                        columnName = "pin_1"
                        newDataType = "java.sql.Types.VARCHAR(4)"/>

        <modifyDataType tableName = "asset"
                        columnName = "pin_2"
                        newDataType = "java.sql.Types.VARCHAR(4)"/>

        <modifyDataType tableName = "asset"
                        columnName = "puk_1"
                        newDataType = "java.sql.Types.VARCHAR(8)"/>

        <modifyDataType tableName = "asset"
                        columnName = "puk_2"
                        newDataType = "java.sql.Types.VARCHAR(8)"/>
    </changeSet>


    <changeSet context="base" id="JBADEN-449" author="Vipul Yadav">
        <comment>Subscribers' total count show only in the admin and finance role</comment>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Show customer count"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>
    </changeSet>

    <changeSet id="jbaden-389" author="Vipul Yadav" context="base">
        <comment> add new two column to store reissue count and reissue date </comment>
        <addColumn tableName="customer">
            <column defaultValueNumeric="0" name="reissue_count" type="java.sql.Types.INTEGER">
                <constraints nullable="false"/>
            </column>
        </addColumn>
        <addColumn tableName="customer">
            <column name="reissue_date" type="java.sql.Types.DATE">
                <constraints nullable="true"/>
            </column>
        </addColumn>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="User exceeds reissue limit"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="JBADEN-442: auto-renewal not display in all the report" author="Nitin Yewale">
        <comment>Added new dropdown for displaying only auto-renewal transactions. </comment>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)"/>
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "trn_source" />
        </insert>
        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)"/>
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "trn_source" />
        </insert>
    </changeSet>

    <changeSet context="base" id="JBADEN-502" author="Nitin Yewale">
        <comment>Display add filter button on the basis of permission.</comment>

        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Customer')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="View Add Filters"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 3);
        </sql>
    </changeSet>

    <changeSet context="base" id="JBADEN-469" author="Vipul Yadav">
        <comment>Added user status </comment>

        <insert tableName="user_status">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from user_status p),1)"/>
            <column name="can_login" value="1"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="9"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from user_status p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Deactivated"/>
        </insert>
    </changeSet>

    <changeSet id="JBADEN-509" author="Nitin Yewale" context="base">
        <comment> add a new column to save suspended username.</comment>
        <addColumn tableName="asset">
            <column name="suspended_by" type="java.sql.Types.VARCHAR(512)">
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet context="base" id="JBADEN-607" author="Nitin Yewale">
        <comment>adding audit log message for asset update</comment>
        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Subscriber status was changed"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="JBADEN-462" author="Nitin Yewale">
        <comment>adding new report parameters for plan name filter.</comment>

        <insert tableName="report_parameter">
            <column name="id"
                    valueComputed="COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)"/>
            <column name="report_id"
                    valueComputed="COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_finance_total_report'),1)"/>
            <column name="dtype" value="string"/>
            <column name="name" value="plan_name"/>
        </insert>
        <insert tableName="report_parameter">
            <column name="id"
                    valueComputed="COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)"/>
            <column name="report_id"
                    valueComputed="COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_crm_user_report'),1)"/>
            <column name="dtype" value="string"/>
            <column name="name" value="plan_name"/>
        </insert>
        <insert tableName="report_parameter">
            <column name="id"
                    valueComputed="COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)"/>
            <column name="report_id"
                    valueComputed="COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_ums_bank_user_report'),1)"/>
            <column name="dtype" value="string"/>
            <column name="name" value="plan_name"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="JBADEN:461 Report" author="Nitin Yewale">
        <comment>Update data type for parameter username and bank_user_name</comment>
        <update tableName="report_parameter">
            <column name="dtype" value="list" />
            <where> name = 'user_name' AND report_id= 30 </where>
        </update>

        <update tableName="report_parameter">
            <column name="dtype" value="list" />
            <where> name = 'user_name' AND report_id= 31 </where>
        </update>

        <update tableName="report_parameter">
            <column name="dtype" value="list" />
            <where> name = 'bank_user_name' AND report_id= 32 </where>
        </update>
    </changeSet>

    <changeSet context="base" id="JBADEN-1606" author="Vipul Yadav">
        <comment>Adding audit log message ids for audit log report</comment>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Sim reissued"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Customer type was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Governorate was updated"/>
        </insert>
        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Identification type was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Identification text was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Identification image was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="First name was updated "/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Last name was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Address line 1 was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Address line 2 was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="City was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="State was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Postal code was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Country was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Contact number was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Email id was updated"/>
        </insert>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Sim reissue refunded"/>
        </insert>

        <!--Update description-->
        <update tableName="international_description">
            <column name="content" value="Reissue limit exceeded"/>
            <where>table_id = 47 AND psudo_column='description' AND foreign_id =44
                AND language_id=1 AND content='User exceeds reissue limit'</where>
        </update>

        <update tableName="international_description">
            <column name="content" value="Subscriber status was updated"/>
            <where>table_id = 47 AND psudo_column='description' AND foreign_id =45
                AND language_id=1</where>
        </update>

        <!--Add new column-->
        <addColumn tableName="event_log">
            <column name="subscriber_number" type="java.sql.Types.VARCHAR(10)">
                <constraints nullable="true"/>
            </column>
        </addColumn>

    </changeSet>

    <changeSet context="base" id="JBADEN-1600" author="Nitin Yewale">
        <comment>Audit Log Report and permission</comment>

        <insert tableName = "report">
            <column name  = "id"        valueComputed = "COALESCE((SELECT MAX(id)+1 FROM report),1)" />
            <column name  = "type_id"   valueComputed = "COALESCE((SELECT id FROM report_type rt WHERE rt.name = 'adennet'),1)" />
            <column name  = "name"      value         = "adennet_audit_log_report" />
            <column name  = "file_name" value         = "adennet_audit_log_report.jasper" />
            <column name  = "optlock"   valueNumeric  = "0" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_audit_log_report'),1)" />
            <column name = "dtype"     value         = "date" />
            <column name = "name"      value         = "start_date" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_audit_log_report'),1)" />
            <column name = "dtype"     value         = "date" />
            <column name = "name"      value         = "end_date" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_audit_log_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "subscriber_number" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_audit_log_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "user_name" />
        </insert>

        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_audit_log_report'),1)" />
            <column name = "dtype"     value         = "list" />
            <column name = "name"      value         = "field_name" />
        </insert>
        <sql>
            INSERT INTO entity_report_map(report_id, entity_id)
            SELECT (SELECT r.id
            FROM report r
            WHERE r.name = 'adennet_audit_log_report'),
            id
            FROM entity
            WHERE deleted = 0
        </sql>

        <!--report permission entry-->        
        <insert tableName="permission">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from permission p),1)"/>
            <column name="type_id" valueComputed="(SELECT id FROM permission_type WHERE description='Report')"/>
            <column name="foreign_id"/>
            <column name="role_assignable" valueBoolean="true"/>
            <column name="user_assignable" valueBoolean="false"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="59"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from permission p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="View Audit Log Report"/>
        </insert>

        <sql>
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = -1);
            INSERT INTO permission_role_map (permission_id, role_id)(SELECT (COALESCE((select max(p.id) from permission p),1)),id FROM role WHERE role_type_id = 2);
        </sql>
    </changeSet>

    <changeSet context="base" id="JBADEN-1618" author="Nitin Yewale">
        <comment>Adding a new parameter in audit_log_report to filter the data by user_id</comment>
        <insert tableName = "report_parameter">
            <column name = "id"        valueComputed = "COALESCE((SELECT COALESCE(MAX(rp.id), 1) + 1 FROM report_parameter rp),1)" />
            <column name = "report_id" valueComputed = "COALESCE((SELECT id FROM report r WHERE r.name = 'adennet_audit_log_report'),1)" />
            <column name = "dtype"     value         = "string" />
            <column name = "name"      value         = "user_id" />
        </insert>
    </changeSet>

    <changeSet context="base" id="JBADEN-1658" author="Nitin Yewale">
        <comment>Adding audit log message id for audit log report</comment>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="User was deleted"/>
        </insert>
    </changeSet>
    <changeSet context="base" id="JBADEN-1709" author="Vipul Yadav">
        <comment>Adding audit log message id for download customer csv</comment>

        <insert tableName="event_log_message">
            <column name="id" valueComputed="COALESCE((select max(p.id)+1 from event_log_message p),1)"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueNumeric="47"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(p.id) from event_log_message p),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Customer CSV"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="ISSUE-583" author="Vipul Yadav">
        <comment>Adding a new parameter in preference_type to manage customer user name validation</comment>
        <insert tableName="preference_type">
            <column name="id" valueComputed="COALESCE((select max(pt.id)+1 from preference_type pt),1)"/>
            <column name="def_value" value="1"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueComputed="(select id From jbilling_table where name = 'preference_type')"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(pt.id) from preference_type pt),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Apply customer user name validation"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="convergent-billing" author="Vipul Yadav">
        <comment>Adding a new parameter in preference_type to call UMS on order creation</comment>
        <insert tableName="preference_type">
            <column name="id" valueComputed="COALESCE((select max(pt.id)+1 from preference_type pt),1)"/>
            <column name="def_value" value="0"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueComputed="(select id From jbilling_table where name = 'preference_type')"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(pt.id) from preference_type pt),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Call UMS on an order creation"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="rename-reports" author="Vipul Yadav">
        <comment>Rename adennet reports to prepaid reports</comment>
        <update tableName="international_description">
            <column name="content" value="Prepaid Reports"/>
            <where> content = 'Adennet Reports' </where>
        </update>

        <comment>Rename SPC Reconciliation Reports to Reconciliation Reports</comment>
        <update tableName="international_description">
            <column name="content" value="Reconciliation Reports"/>
            <where> content = 'SPC Reconciliation Reports' </where>
        </update>

        <comment>Remove adennet_ prefix from reports name.</comment>
        <update tableName="report">
            <column name="name" value="ums_finance_total_report"/>
            <column name="file_name" value="ums_finance_total_report.jasper"/>
            <where> name = 'adennet_ums_finance_total_report' </where>
        </update>
        <update tableName="report">
            <column name="name" value="ums_crm_user_report"/>
            <column name="file_name" value="ums_crm_user_report.jasper"/>
            <where> name = 'adennet_ums_crm_user_report' </where>
        </update>
        <update tableName="report">
            <column name="name" value="ums_bank_user_report"/>
            <column name="file_name" value="ums_bank_user_report.jasper"/>
            <where> name = 'adennet_ums_bank_user_report' </where>
        </update>
        <update tableName="report">
            <column name="name" value="ums_inactive_subscriber_numbers_report"/>
            <column name="file_name" value="ums_inactive_subscriber_numbers_report.jasper"/>
            <where> name = 'adennet_ums_inactive_subscriber_numbers_report' </where>
        </update>
        <update tableName="report">
            <column name="name" value="audit_log_report"/>
            <column name="file_name" value="audit_log_report.jasper"/>
            <where> name = 'adennet_audit_log_report' </where>
        </update>
    </changeSet>

    <changeSet id="EARNBILL-897:Rename-spc-report" author="Raushan Kumar Raj" context="base">
        <update tableName="report">
            <column name="name" value="ageing_balance_detail"/>
            <column name="file_name" value="ageing_balance_detail.jasper"/>
            <where>name = 'spc_ageing_balance_detail'</where>
        </update>

        <update tableName="report">
            <column name="name" value="gl_detail"/>
            <column name="file_name" value="gl_detail.jasper"/>
            <where>name = 'spc_gl_detail'</where>
        </update>

        <update tableName="report">
            <column name="name" value="gl_summary"/>
            <column name="file_name" value="gl_summary.jasper"/>
            <where>name = 'spc_gl_summary'</where>
        </update>

        <update tableName="report">
            <column name="name" value="refund_payments"/>
            <column name="file_name" value="refund_payments.jasper"/>
            <where>name = 'spc_refund_payments'</where>
        </update>
    </changeSet>

    <changeSet context="base" id="convergent-billing : Add new table Prepaid Service Summary Details."
               author="Vipul Yadav">
        <createTable tableName="prepaid_service_summary">
            <column name="id" type="java.sql.Types.INTEGER">
                <constraints nullable="false"
                             primaryKey="true"
                             primaryKeyName="prepaid_service_summary_pkey"/>
            </column>
            <column name="service_summary_id" type="java.sql.Types.INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="data_quantity" type="java.sql.Types.NUMERIC(22, 2)"/>
            <column name="voice_quantity" type="java.sql.Types.NUMERIC(22, 2)"/>
            <column name="sms_quantity" type="java.sql.Types.NUMERIC(22, 2)"/>
            <column name="start_date" type="java.sql.Types.TIMESTAMP"/>
            <column name="end_date" type="java.sql.Types.TIMESTAMP"/>

        </createTable>
        <addForeignKeyConstraint constraintName="prepaid_service_summary_fk_service_summary"
                                 baseTableName="prepaid_service_summary"
                                 referencedTableName="service_summary"
                                 baseColumnNames="service_summary_id"
                                 referencedColumnNames="id"/>

        <insert tableName="jbilling_seqs">
            <column name="name" value="prepaid_service_summary"/>
            <column name="next_id" valueNumeric="1"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="convergent-billing: downgrade fees preference" author="Sachet Shandilya">
        <comment>Adding a new parameter in preference_type to apply downgrade fees</comment>
        <insert tableName="preference_type">
            <column name="id" valueComputed="COALESCE((select max(pt.id)+1 from preference_type pt),1)"/>
            <column name="def_value" value="0"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueComputed="(select id From jbilling_table where name = 'preference_type')"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(pt.id) from preference_type pt),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Is Downgrade Fees Applicable"/>
        </insert>
    </changeSet>

    <changeSet context="base" id="convergent-billing: recharge request and wallet topups" author="Sachet Shandilya">
        <comment>Adding a new parameter in preference_type to determine if recharge request and wallet topus are supported</comment>
        <insert tableName="preference_type">
            <column name="id" valueComputed="COALESCE((select max(pt.id)+1 from preference_type pt),1)"/>
            <column name="def_value" value="0"/>
        </insert>

        <insert tableName="international_description">
            <column name="table_id" valueComputed="(select id From jbilling_table where name = 'preference_type')"/>
            <column name="foreign_id" valueComputed="COALESCE((select max(pt.id) from preference_type pt),1)"/>
            <column name="psudo_column" value="description"/>
            <column name="language_id" valueNumeric="1"/>
            <column name="content" value="Support Prepaid Recharge requests and Wallet Top ups"/>
        </insert>
    </changeSet>

</databaseChangeLog>
